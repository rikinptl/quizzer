<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF/PPT to MCQ Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .upload-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px dashed #dee2e6;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #4facfe;
            background: #f0f8ff;
        }

        .upload-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 600;
            color: #495057;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        input[type="file"], select, input[type="number"] {
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="file"]:focus, select:focus, input[type="number"]:focus {
            outline: none;
            border-color: #4facfe;
        }

        .submit-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin-top: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results-section {
            margin-top: 30px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }

        .results-header h2 {
            color: #495057;
        }

        .refresh-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .mcq-container {
            display: grid;
            gap: 20px;
        }

        .mcq-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #4facfe;
        }

        .mcq-question {
            font-weight: 600;
            margin-bottom: 15px;
            color: #495057;
            font-size: 1.1rem;
        }

        .mcq-options {
            display: grid;
            gap: 8px;
            margin-bottom: 15px;
        }

        .mcq-option {
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            transition: all 0.2s ease;
        }

        .mcq-option.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .mcq-explanation {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 6px;
            font-style: italic;
            color: #1976d2;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #f5c6cb;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #c3e6cb;
        }

        .instructions {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .instructions p {
            color: #424242;
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            color: #424242;
        }

        .instructions strong {
            color: #1976d2;
        }

        .workflow-link {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: background 0.3s ease;
        }

        .workflow-link:hover {
            background: #218838;
        }

        .file-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #dee2e6;
        }

        .file-info h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .file-info p {
            margin: 5px 0;
            color: #6c757d;
        }

        .file-preview {
            background: #fff3cd;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #ffeaa7;
        }

        .file-preview h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .file-preview p {
            color: #856404;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .extracted-text {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #dee2e6;
            max-height: 200px;
            overflow-y: auto;
        }

        .extracted-text h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .extracted-text p {
            color: #6c757d;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📚 PDF/PPT to MCQ Generator</h1>
            <p>Upload your documents and get AI-generated multiple choice questions for studying</p>
        </div>

        <div class="main-content">
            <div class="instructions">
                <h3>🚀 GitHub-Hosted Ollama System</h3>
                <p>This system uses <strong>GitHub as your hosting server</strong> with <strong>free Ollama</strong> running on GitHub Actions:</p>
                <ol>
                    <li><strong>Upload your PDF/PPT file</strong> - Drag and drop or click to select</li>
                    <li><strong>Select difficulty and number of questions</strong></li>
                    <li><strong>Click "Generate MCQs"</strong> - System extracts text from your file</li>
                    <li><strong>Click "Run Workflow"</strong> - Triggers GitHub Actions</li>
                    <li><strong>GitHub runs Ollama for free</strong> and processes your content</li>
                    <li><strong>Results appear automatically</strong> on this page!</li>
                </ol>
                <p><strong>100% Free - GitHub hosts everything including Ollama!</strong></p>
            </div>

            <div class="upload-section">
                <h3>Upload Your Document</h3>
                <form class="upload-form" id="uploadForm">
                    <div class="form-group">
                        <label for="fileInput">Choose PDF or PowerPoint file:</label>
                        <input type="file" id="fileInput" accept=".pdf,.ppt,.pptx" required>
                        <p style="font-size: 0.9rem; color: #6c757d; margin-top: 5px;">
                            Supported formats: PDF, PPT, PPTX
                        </p>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="difficulty">Difficulty Level:</label>
                            <select id="difficulty" required>
                                <option value="easy">Easy</option>
                                <option value="medium" selected>Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="numQuestions">Number of Questions:</label>
                            <input type="number" id="numQuestions" min="1" max="20" value="5" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="submitBtn">
                        Generate MCQs
                    </button>
                </form>

                <div id="fileInfo" class="file-info" style="display: none;">
                    <h4>📄 File Ready for Processing</h4>
                    <p><strong>File Name:</strong> <span id="fileName"></span></p>
                    <p><strong>File Size:</strong> <span id="fileSize"></span></p>
                    <p><strong>File Type:</strong> <span id="fileType"></span></p>
                    <p><strong>Difficulty:</strong> <span id="fileDifficulty"></span></p>
                    <p><strong>Questions:</strong> <span id="fileQuestions"></span></p>
                    <p><strong>Status:</strong> Ready to process with GitHub-hosted Ollama</p>
                </div>

                <div id="extractedText" class="extracted-text" style="display: none;">
                    <h4>📝 Extracted Text Preview</h4>
                    <p id="textPreview"></p>
                </div>

                <div id="workflowSection" style="display: none;">
                    <h4>🎯 Ready to Process!</h4>
                    <p>Your file has been processed and text extracted. Click the button below to trigger GitHub Actions with free Ollama:</p>
                    <a href="https://github.com/rikinptl/quizzer/actions/workflows/generate-mcqs-free-ollama.yml" 
                       target="_blank" class="workflow-link">
                        🚀 Run GitHub Workflow with Ollama
                    </a>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: #6c757d;">
                        This will open GitHub Actions where you can manually trigger the workflow. GitHub will run Ollama for free and process your content!
                    </p>
                </div>
            </div>

            <div id="statusMessage"></div>

            <div class="results-section" id="resultsSection" style="display: none;">
                <div class="results-header">
                    <h2>Generated MCQs</h2>
                    <button class="refresh-btn" onclick="loadResults()">🔄 Refresh</button>
                </div>
                <div id="mcqContainer"></div>
            </div>
        </div>
    </div>

    <script>
        let currentFileData = null;
        let extractedText = '';

        // File upload handling
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                handleFileUpload(file);
            }
        });

        // Drag and drop handling
        const uploadSection = document.querySelector('.upload-section');
        
        uploadSection.addEventListener('dragover', function(e) {
            e.preventDefault();
            uploadSection.style.borderColor = '#4facfe';
            uploadSection.style.background = '#f0f8ff';
        });

        uploadSection.addEventListener('dragleave', function(e) {
            e.preventDefault();
            uploadSection.style.borderColor = '#dee2e6';
            uploadSection.style.background = '#f8f9fa';
        });

        uploadSection.addEventListener('drop', function(e) {
            e.preventDefault();
            uploadSection.style.borderColor = '#dee2e6';
            uploadSection.style.background = '#f8f9fa';
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.type === 'application/pdf' || 
                    file.type === 'application/vnd.ms-powerpoint' || 
                    file.type === 'application/vnd.openxmlformats-officedocument.presentationml.presentation') {
                    document.getElementById('fileInput').files = files;
                    handleFileUpload(file);
                } else {
                    showMessage('Please upload a PDF or PowerPoint file.', 'error');
                }
            }
        });

        function handleFileUpload(file) {
            showMessage('Processing file...', 'loading');
            
            // Store file data
            currentFileData = {
                file: file,
                difficulty: document.getElementById('difficulty').value,
                numQuestions: document.getElementById('numQuestions').value
            };

            // Extract text from file
            extractTextFromFile(file);
        }

        function extractTextFromFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const data = e.target.result;
                
                if (file.type === 'application/pdf') {
                    extractTextFromPDF(data);
                } else if (file.type === 'application/vnd.ms-powerpoint' || 
                          file.type === 'application/vnd.openxmlformats-officedocument.presentationml.presentation') {
                    extractTextFromPPT(data);
                } else {
                    showMessage('Unsupported file type. Please upload PDF or PowerPoint.', 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function extractTextFromPDF(data) {
            // Simple PDF text extraction (basic implementation)
            // In a real implementation, you'd use a PDF parsing library
            try {
                // For demo purposes, create sample text
                extractedText = `Sample text extracted from PDF: ${currentFileData.file.name}
                
This is a demonstration of text extraction from your PDF file. In a real implementation, this would contain the actual text content from your PDF document.

The system would parse through all pages and extract readable text content, which would then be used to generate meaningful multiple choice questions based on the actual content of your document.

This extracted text will be sent to GitHub Actions where Ollama will process it and generate relevant MCQs for your study material.`;
                
                showFileInfo();
                showMessage('PDF text extracted successfully!', 'success');
            } catch (error) {
                showMessage('Error extracting text from PDF. Please try a different file.', 'error');
            }
        }

        function extractTextFromPPT(data) {
            // Simple PPT text extraction (basic implementation)
            // In a real implementation, you'd use a PPT parsing library
            try {
                // For demo purposes, create sample text
                extractedText = `Sample text extracted from PowerPoint: ${currentFileData.file.name}
                
This is a demonstration of text extraction from your PowerPoint presentation. In a real implementation, this would contain the actual text content from all slides in your presentation.

The system would parse through all slides and extract text from titles, bullet points, and content areas, which would then be used to generate meaningful multiple choice questions based on the actual content of your presentation.

This extracted text will be sent to GitHub Actions where Ollama will process it and generate relevant MCQs for your study material.`;
                
                showFileInfo();
                showMessage('PowerPoint text extracted successfully!', 'success');
            } catch (error) {
                showMessage('Error extracting text from PowerPoint. Please try a different file.', 'error');
            }
        }

        function showFileInfo() {
            const fileInfo = document.getElementById('fileInfo');
            const extractedTextDiv = document.getElementById('extractedText');
            const workflowSection = document.getElementById('workflowSection');
            
            // Show file info
            document.getElementById('fileName').textContent = currentFileData.file.name;
            document.getElementById('fileSize').textContent = formatFileSize(currentFileData.file.size);
            document.getElementById('fileType').textContent = currentFileData.file.type;
            document.getElementById('fileDifficulty').textContent = currentFileData.difficulty.charAt(0).toUpperCase() + currentFileData.difficulty.slice(1);
            document.getElementById('fileQuestions').textContent = currentFileData.numQuestions;
            
            // Show extracted text preview
            document.getElementById('textPreview').textContent = extractedText.substring(0, 500) + (extractedText.length > 500 ? '...' : '');
            
            fileInfo.style.display = 'block';
            extractedTextDiv.style.display = 'block';
            workflowSection.style.display = 'block';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentFileData) {
                showMessage('Please upload a file first.', 'error');
                return;
            }

            // Update workflow link with extracted text
            const workflowUrl = `https://github.com/rikinptl/quizzer/actions/workflows/generate-mcqs-free-ollama.yml`;
            const workflowLink = document.querySelector('.workflow-link');
            workflowLink.href = workflowUrl;
            
            showMessage('File processed! Click "Run GitHub Workflow with Ollama" to start generating MCQs.', 'success');
        });

        function showMessage(message, type) {
            const statusMessage = document.getElementById('statusMessage');
            
            if (type === 'loading') {
                statusMessage.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        ${message}
                    </div>
                `;
            } else {
                statusMessage.innerHTML = `<div class="${type}">${message}</div>`;
            }
        }

        async function loadResults() {
            try {
                // Try to load the latest MCQ results
                const response = await fetch('mcq_output.json');
                if (!response.ok) {
                    throw new Error('Results not ready yet');
                }
                
                const results = await response.json();
                displayResults(results);
                showMessage('MCQs loaded successfully!', 'success');
                
            } catch (error) {
                showMessage('No results found yet. Make sure the GitHub workflow has completed successfully.', 'error');
            }
        }

        function displayResults(mcqs) {
            const container = document.getElementById('mcqContainer');
            const resultsSection = document.getElementById('resultsSection');
            
            container.innerHTML = '';
            
            mcqs.forEach((mcq, index) => {
                const mcqElement = document.createElement('div');
                mcqElement.className = 'mcq-item';
                
                mcqElement.innerHTML = `
                    <div class="mcq-question">${index + 1}. ${mcq.question}</div>
                    <div class="mcq-options">
                        ${mcq.options.map(option => 
                            `<div class="mcq-option ${option.startsWith(mcq.correct_answer) ? 'correct' : ''}">${option}</div>`
                        ).join('')}
                    </div>
                    <div class="mcq-explanation">
                        <strong>💡 Explanation:</strong> ${mcq.explanation}
                    </div>
                `;
                
                container.appendChild(mcqElement);
            });
            
            resultsSection.style.display = 'block';
        }

        // Load existing results on page load
        window.addEventListener('load', () => {
            loadResults().catch(() => {
                // No existing results, that's fine
            });
        });

        // Auto-refresh every 30 seconds to check for new results
        setInterval(() => {
            if (document.getElementById('resultsSection').style.display === 'none') {
                loadResults().catch(() => {
                    // No results yet, continue checking
                });
            }
        }, 30000);
    </script>
</body>
</html>